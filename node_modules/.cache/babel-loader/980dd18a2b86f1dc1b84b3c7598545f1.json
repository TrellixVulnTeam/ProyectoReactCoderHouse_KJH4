{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Flavio\\\\Desktop\\\\React Proyect\\\\Magios-Team-Coder\\\\src\\\\components\\\\Ventas\\\\Checkout.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState } from \"react\";\nimport { getFirestore } from \"../../firebase\";\nimport firebase from \"firebase/app\";\nimport \"firebase/firebase\";\nimport { useCartContext } from \"../../context/context\";\nimport styled from \"styled-components\";\nimport ProductosCheckout from \"./ProductosCheckout\";\nimport Formcheckout from \"./Formcheckout\";\nimport accounting from \"accounting\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst DivCheckout = styled.div`\n\tfont-family: \"Source Sans Pro\", sans-serif;\n`;\n_c = DivCheckout;\nconst Mtop = styled.div`\n\tmargin-top: 15%;\n`;\n_c2 = Mtop;\n\nconst Checkout = () => {\n  _s();\n\n  const {\n    precioTotal,\n    userName\n  } = useCartContext();\n  const [nombre, setNombre] = useState(\"\");\n  const [telefono, setTelefono] = useState(\"\");\n  const [email, setEmail] = useState(\"\");\n  const {\n    cart,\n    clearCart\n  } = useCartContext();\n  const [orderId, setOrderId] = useState();\n\n  const manejarCompra = e => {\n    e.preventDefault();\n    const datosCompra = {\n      comprador: {\n        name: nombre,\n        phone: telefono,\n        email: email\n      },\n      date: firebase.firestore.FieldValue.serverTimestamp(),\n      items: cart,\n      total: precioTotal\n    };\n    const db = getFirestore();\n    const OrderCollection = db.collection(\"orders\");\n\n    const ordenes = async () => {\n      try {\n        const pregunta = await OrderCollection.add(datosCompra);\n        const respuesta = pregunta.id;\n        clearCart();\n        setOrderId(respuesta);\n      } catch (error) {\n        console.log(error);\n      }\n    };\n\n    ordenes();\n    const itemsUpdate = db.collection(\"items\").where(firebase.firestore.FieldPath.documentId(), \"in\", cart.map(i => i.item.id));\n\n    const updateStock = async () => {\n      const query = await itemsUpdate.get();\n      const batch = db.batch();\n      query.docs.forEach((docSnapshot, idx) => {\n        batch.update(docSnapshot.ref, {\n          stock: docSnapshot.data().stock - Number(cart[idx].cantidad)\n        });\n      });\n      batch.commit();\n    };\n\n    updateStock();\n  };\n\n  return /*#__PURE__*/_jsxDEV(DivCheckout, {\n    className: \"container\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"row\",\n      children: orderId ? /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: /*#__PURE__*/_jsxDEV(Mtop, {\n          className: \"text-center\",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            className: \"fs-1\",\n            children: \"Compra realizada con exito, muchas gracias por elegirnos!\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 81,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"fs-4\",\n            children: [\"Tu numero de pedido es: \", /*#__PURE__*/_jsxDEV(\"strong\", {\n              children: orderId\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 83,\n              columnNumber: 34\n            }, this), \" \"]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 82,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            className: \"fs-4\",\n            children: \"Proximamente estaras recibiendo un correo electronico con los detalles de tu compra y el codigo para realizar el seguimiento del pedido. \\uD83D\\uDE04\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 9\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 80,\n          columnNumber: 8\n        }, this)\n      }, void 0, false) : /*#__PURE__*/_jsxDEV(_Fragment, {\n        children: [/*#__PURE__*/_jsxDEV(Formcheckout, {\n          manejarCompra: manejarCompra,\n          setNombre: setNombre,\n          setTelefono: setTelefono,\n          setEmail: setEmail,\n          nombre: nombre,\n          telefono: telefono,\n          email: email\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 90,\n          columnNumber: 8\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"col-lg-4 shadow-lg p-3 ms-2 bg-body carrito margin-form \",\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: \"Detalle de tu compra:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 100,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(ProductosCheckout, {\n            cart: cart\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 9\n          }, this), /*#__PURE__*/_jsxDEV(\"h5\", {\n            children: \"Env\\xEDo Gratis\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 102,\n            columnNumber: 9\n          }, this), precioTotal ? /*#__PURE__*/_jsxDEV(\"h4\", {\n            children: [\"Subtotal: \", accounting.formatMoney(precioTotal)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 104,\n            columnNumber: 10\n          }, this) : null]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 99,\n          columnNumber: 8\n        }, this)]\n      }, void 0, true)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 4\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 75,\n    columnNumber: 3\n  }, this);\n};\n\n_s(Checkout, \"WUdBC8rROo5ZumJfW8U5IDl8MRM=\", false, function () {\n  return [useCartContext, useCartContext];\n});\n\n_c3 = Checkout;\nexport default Checkout;\n\nvar _c, _c2, _c3;\n\n$RefreshReg$(_c, \"DivCheckout\");\n$RefreshReg$(_c2, \"Mtop\");\n$RefreshReg$(_c3, \"Checkout\");","map":{"version":3,"sources":["C:/Users/Flavio/Desktop/React Proyect/Magios-Team-Coder/src/components/Ventas/Checkout.js"],"names":["React","useState","getFirestore","firebase","useCartContext","styled","ProductosCheckout","Formcheckout","accounting","DivCheckout","div","Mtop","Checkout","precioTotal","userName","nombre","setNombre","telefono","setTelefono","email","setEmail","cart","clearCart","orderId","setOrderId","manejarCompra","e","preventDefault","datosCompra","comprador","name","phone","date","firestore","FieldValue","serverTimestamp","items","total","db","OrderCollection","collection","ordenes","pregunta","add","respuesta","id","error","console","log","itemsUpdate","where","FieldPath","documentId","map","i","item","updateStock","query","get","batch","docs","forEach","docSnapshot","idx","update","ref","stock","data","Number","cantidad","commit","formatMoney"],"mappings":"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","sourcesContent":["import React, { useState } from \"react\";\nimport { getFirestore } from \"../../firebase\";\nimport firebase from \"firebase/app\";\nimport \"firebase/firebase\";\nimport { useCartContext } from \"../../context/context\";\nimport styled from \"styled-components\";\nimport ProductosCheckout from \"./ProductosCheckout\";\nimport Formcheckout from \"./Formcheckout\";\nimport accounting from \"accounting\";\n\nconst DivCheckout = styled.div`\n\tfont-family: \"Source Sans Pro\", sans-serif;\n`;\nconst Mtop = styled.div`\n\tmargin-top: 15%;\n`;\n\nconst Checkout = () => {\n\tconst { precioTotal, userName } = useCartContext();\n\tconst [nombre, setNombre] = useState(\"\");\n\tconst [telefono, setTelefono] = useState(\"\");\n\tconst [email, setEmail] = useState(\"\");\n\tconst { cart, clearCart } = useCartContext();\n\tconst [orderId, setOrderId] = useState();\n\n\tconst manejarCompra = (e) => {\n\t\te.preventDefault();\n\t\tconst datosCompra = {\n\t\t\tcomprador: {\n\t\t\t\tname: nombre,\n\t\t\t\tphone: telefono,\n\t\t\t\temail: email,\n\t\t\t},\n\t\t\tdate: firebase.firestore.FieldValue.serverTimestamp(),\n\t\t\titems: cart,\n\t\t\ttotal: precioTotal,\n\t\t};\n\n\t\tconst db = getFirestore();\n\t\tconst OrderCollection = db.collection(\"orders\");\n\n\t\tconst ordenes = async () => {\n\t\t\ttry {\n\t\t\t\tconst pregunta = await OrderCollection.add(datosCompra);\n\t\t\t\tconst respuesta = pregunta.id;\n\t\t\t\tclearCart();\n\t\t\t\tsetOrderId(respuesta);\n\t\t\t} catch (error) {\n\t\t\t\tconsole.log(error);\n\t\t\t}\n\t\t};\n\t\tordenes();\n\n\t\tconst itemsUpdate = db.collection(\"items\").where(\n\t\t\tfirebase.firestore.FieldPath.documentId(),\n\t\t\t\"in\",\n\t\t\tcart.map((i) => i.item.id)\n\t\t);\n\n\t\tconst updateStock = async () => {\n\t\t\tconst query = await itemsUpdate.get();\n\t\t\tconst batch = db.batch();\n\t\t\tquery.docs.forEach((docSnapshot, idx) => {\n\t\t\t\tbatch.update(docSnapshot.ref, {\n\t\t\t\t\tstock: docSnapshot.data().stock - Number(cart[idx].cantidad),\n\t\t\t\t});\n\t\t\t});\n\t\t\tbatch.commit();\n\t\t};\n\n\t\tupdateStock();\n\t};\n\n\treturn (\n\t\t<DivCheckout className=\"container\">\n\t\t\t<div className=\"row\">\n\t\t\t\t{\n\t\t\t\t\torderId ? (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Mtop className=\"text-center\">\n\t\t\t\t\t\t\t\t<h3 className=\"fs-1\">Compra realizada con exito, muchas gracias por elegirnos!</h3>\n\t\t\t\t\t\t\t\t<p className=\"fs-4\">\n\t\t\t\t\t\t\t\t\tTu numero de pedido es: <strong>{orderId}</strong>{\" \"}\n\t\t\t\t\t\t\t\t</p>\n\t\t\t\t\t\t\t\t<p className=\"fs-4\">Proximamente estaras recibiendo un correo electronico con los detalles de tu compra y el codigo para realizar el seguimiento del pedido. 😄</p>\n\t\t\t\t\t\t\t</Mtop>\n\t\t\t\t\t\t</>\n\t\t\t\t\t) : (\n\t\t\t\t\t\t<>\n\t\t\t\t\t\t\t<Formcheckout\n\t\t\t\t\t\t\t\tmanejarCompra={manejarCompra}\n\t\t\t\t\t\t\t\tsetNombre={setNombre}\n\t\t\t\t\t\t\t\tsetTelefono={setTelefono}\n\t\t\t\t\t\t\t\tsetEmail={setEmail}\n\t\t\t\t\t\t\t\tnombre={nombre}\n\t\t\t\t\t\t\t\ttelefono={telefono}\n\t\t\t\t\t\t\t\temail={email}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<div className=\"col-lg-4 shadow-lg p-3 ms-2 bg-body carrito margin-form \">\n\t\t\t\t\t\t\t\t<h3>Detalle de tu compra:</h3>\n\t\t\t\t\t\t\t\t<ProductosCheckout cart={cart} />\n\t\t\t\t\t\t\t\t<h5>Envío Gratis</h5>\n\t\t\t\t\t\t\t\t{precioTotal ? (\n\t\t\t\t\t\t\t\t\t<h4>Subtotal: {accounting.formatMoney(precioTotal)}</h4>\n\t\t\t\t\t\t\t\t) : null}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</>\n\t\t\t\t\t)\n\t\t\t\t}\n\t\t\t</div>\n\t\t</DivCheckout>\n\t);\n};\n\nexport default Checkout;\n"]},"metadata":{},"sourceType":"module"}